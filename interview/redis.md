1.redis数据结构
string 动态字符串
list 双向链表和压缩列表
hash ziplist压缩列表和hashtable哈希表
set 整数数组和哈希表
sorted set  跳表和压缩列表
bitmap 用string类型作为底层数据结构实现的一种统计二值状态的数据类型
geo经纬度
streams消息队列
栈 Lpush+Lpop后进先出filo
队列 先进先出 队列 lpush+rpop
阻塞队列 lpush+brpop
2.redis速度快数据类型丰富
3.redis是单线程 运用队列技术将并发访问变成串行访问消除数据库
串行控制的开销
4.删除策略
不删除 lru最近最少使用 lfu最不经常使用 先进先出
5.持久化
rdb
用快照的方式记录redis的所有健值对，在某个时间点将数据写入一个临时文件
aof所有的命令行记录以命令请求协议的格式保存为aof文件
rdb优点:rdb文件紧凑体积小网络传输快，适合全量复制，恢复速度比
aof快很多，对性能影响较小，缺点 不能实时 所以会造成数据大量丢失，
另外rdb文件要满足特定格式兼容性差
aof优点支持秒级持久化兼容性好 缺点文件大恢复速度慢
当aof和rdb同时存在时优先加载aof关闭aof加载rdb

redis4.0提出混合使用，内存快照以一定的频率执行两次快照之间使用aof日志记录

数据不能丢失使用混合，允许分钟级别丢失可以只使用rdb，如果只有aof，优先使用everysec配置。可靠性和性能之间取平衡

6.redis主从复制读写分离

7.缓存击穿 缓存穿透 缓存雪崩

缓存雪崩 大量的应用无法在redis处理直接打到数据库层，数据库压力激增
1.大量数据同时过期
避免设置相同过期时间如果确实需要增加随机数
服务降级非核心数据直接返回空或者预定义值核心数据去数据库处理
2.redis宕机
服务熔断 限流

缓存穿透
数据缓存和数据库中都没有
发生在业务层误操作数据被删除恶意攻击
缓存空值或缺省值
使用布隆过滤器判断数据是否存在
前端进行请求检测

缓存击穿
热点数据缓存无法处理，全部发给数据库，热点数据过期
不设置过期时间

8.redis分布式锁实现
先拿setnx来争抢锁，抢到之后用expire给锁加过期时间避免忘记释放
可以把sexnx和expire合成一条指令
set name zcc ex 100 nx

9.redis做异步任务
list lpush生产消息 rpop 消费消息 没有消息的时候要sleep
一会在重试。也可以用brpop
消费者程序本息要能对重复消息判断，需要业务上给消息带全局唯一id
BRPOPLPUSH可以避免redis挂掉消息丢失从备份list读取消息


10.redis海量数据用scan

11.redis 集群有16384个哈希槽每个key通过crc16校验后取模
决定方哪个槽每个节点负责一部分hash槽
crc16算法2^16=65536,浪费带宽


12.redis写时复制
